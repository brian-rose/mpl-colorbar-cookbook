
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matplotlib: Consistant Colorbars for Comparisons &#8212; Maplotlib Colorbars Cookbook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-pythia-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Maplotlib Colorbars Cookbook" href="../README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="132">
    <div class="container-fluid" id="shim"></div>
    <div class="container-fluid" id="banner"></div>
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://projectpythia.org">
  <img src="../_static/pythia_logo-white-rtext.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ProjectPythia" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/project_pythia" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" rel="noopener" target="_blank" title="YouTube">
            <span><i class="fab fa-youtube-square"></i></span>
            <label class="sr-only">YouTube</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    <div class="container-xl">
      <div class="row">
        
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Maplotlib Colorbars Cookbook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Matplotlib: Consistant Colorbars for Comparisons
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by <a href="https://projectpythia.org">Project Pythia</a>.<br><br>
All code in Pythia Cookbooks is licensed under Apache 2.0. All other non-code content is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons BY 4.0 (CC BY 4.0)</a>.<br><br>

</div>

</div>

        

        <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main"><div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/mpl-colorbar-cookbook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ProjectPythiaCookbooks/mpl-colorbar-cookbook/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ProjectPythiaCookbooks/mpl-colorbar-cookbook//issues/new?title=Issue%20on%20page%20%2Fnotebooks/mpl-colorbar-cookbook.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/ProjectPythiaCookbooks/mpl-colorbar-cookbook/edit/main/notebooks/mpl-colorbar-cookbook.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://binder-staging.2i2c.cloud/v2/gh/ProjectPythiaCookbooks/mpl-colorbar-cookbook/main?urlpath=lab/tree/notebooks/mpl-colorbar-cookbook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> On this page
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-set-up">
   Getting set up
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-in-and-preprocessing-data">
     Loading in and preprocessing data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-the-plot">
   Making the Plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-figure">
     Create the figure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#format-and-populate-subplots">
     Format and populate subplots
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-the-colorbar">
     Making the colorbar
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#colormap-best-practices">
   Colormap Best Practices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#printing-in-black-and-white">
     Printing in Black and White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choosing-accessible-color-palettes">
     Choosing Accessible Color Palettes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternative-color-palettes">
     Alternative Color Palettes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources-and-references">
   Resources and references
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
          <div id="main-content" class="row">
            <div class="col-12 col-md-9 pl-md-3 pr-md-0">
              
              <div>
                
  <p><a class="reference internal" href="../_images/ProjectPythia_Logo_Final-01-Blue.svg"><img alt="Project Pythia Logo" src="../_images/ProjectPythia_Logo_Final-01-Blue.svg" width="250" /></a></img>
<a class="reference internal" href="../_images/matplotlib_logo.svg"><img alt="Matplotlib Logo" src="../_images/matplotlib_logo.svg" width="250" /></a></img></p>
<div class="tex2jax_ignore mathjax_ignore section" id="matplotlib-consistant-colorbars-for-comparisons">
<h1>Matplotlib: Consistant Colorbars for Comparisons<a class="headerlink" href="#matplotlib-consistant-colorbars-for-comparisons" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<hr class="docutils" />
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Analyzing data almost always requires comparing datasets, and when done visually, this is a powerful way to communicate changes in data. However, to do this acurately with color, the colormap used by the plots must be the same. The colors on each plot must have the same meanings or values assigned to them. This cookbook shows how to:</p>
<ol class="simple">
<li><p>create multiple plots but display only one colorbar</p></li>
<li><p>use the same colormap for multiple plots</p></li>
<li><p>choose accessible colormaps and explains best practices when using color</p></li>
</ol>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/cartopy/cartopy.html">Intro to Cartopy</a></p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html">Understanding of NetCDF</a></p></td>
<td><p>Helpful</p></td>
<td><p>Opening data sets</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html#overview">Matplotlib Basics</a></p></td>
<td><p>Necessary</p></td>
<td><p><a class="reference external" href="https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html#contour-and-filled-contour-plots">Contour/Filled Contour Plots</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/xarray-intro.html#opening-netcdf-data">Basic Xarray</a></p></td>
<td><p>Necessary</p></td>
<td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/xarray-intro.html#opening-netcdf-data">Opening netCDF data</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/numpy/numpy-basics.html">Basic Numpy</a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://geocat-viz.readthedocs.io/en/latest/">GeoCAT-viz</a></p></td>
<td><p>Helpful</p></td>
<td><p>For formatting plots</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/ncar/geocat-datafiles">GeoCAT-datafiles</a></p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 15 minutes</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="getting-set-up">
<h2>Getting set up<a class="headerlink" href="#getting-set-up" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="section" id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">geocat.datafiles</span> <span class="k">as</span> <span class="nn">gdf</span>
<span class="kn">import</span> <span class="nn">geocat.viz</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-in-and-preprocessing-data">
<h3>Loading in and preprocessing data<a class="headerlink" href="#loading-in-and-preprocessing-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>The data we are using for this example is from the <a class="reference external" href="https://github.com/NCAR/geocat-datafiles">GeoCAT-datafiles</a> repository on GitHub. The specific file is <code class="docutils literal notranslate"><span class="pre">TS.cam3.toga_ENS.1950-2000.nc</span></code>, and it contains surafce temeprature data from the first run of the CAM3 T85 TOGA model run. We load the data file in using the xarray default engine.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;netcdf_files/TS.cam3.toga_ENS.1950-2000.nc&quot;</span><span class="p">),)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</div>
<p>The file has data from different timesteps of the model. Say we want to plot temperature data from two different timesteps and compare them visually. To see the biggest change, let’s choose a timestep from February and one from August in the same year. We also need to select the variable of interest which is <code class="docutils literal notranslate"><span class="pre">TS</span></code> for surface temperature.</p>
<p>To create the colorbar, we’ll need to know what the minimum and maximum temperatures are. We find those here as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the timesteps</span>
<span class="n">first_step</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">TS</span>
<span class="n">last_step</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">TS</span>

<span class="c1"># Find temperature min/max</span>
<span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="n">first_step</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">last_step</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">first_step</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">last_step</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="making-the-plot">
<h2>Making the Plot<a class="headerlink" href="#making-the-plot" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Due to Jupyter Notebook limitations, the entire plot must be made in the same block. These are the general steps:</p>
<div class="section" id="create-the-figure">
<h3>Create the figure<a class="headerlink" href="#create-the-figure" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>We are using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> to make two plots on the same figure. We need to create the figure and specify our map projection before we can create the two subplots.</p>
</div>
<div class="section" id="format-and-populate-subplots">
<h3>Format and populate subplots<a class="headerlink" href="#format-and-populate-subplots" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Once that’s done, we need to format and populate the subplots. The function <code class="docutils literal notranslate"><span class="pre">create_subplot</span></code> below ensures that both sets of axes are created with the same specifications. <em>Most importantly, it makes sure that both plots are drawn with the same <code class="docutils literal notranslate"><span class="pre">levels</span></code> keyword for <code class="docutils literal notranslate"><span class="pre">contourf</span></code>.</em> This keyword is what specifies how the colors are assigned to values. As long as <code class="docutils literal notranslate"><span class="pre">levels</span></code> is the same between contour plots, the images will be useful for making accurate comparisions.</p>
</div>
<div class="section" id="making-the-colorbar">
<h3>Making the colorbar<a class="headerlink" href="#making-the-colorbar" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">contourf</span></code> returns a <code class="docutils literal notranslate"><span class="pre">QuadContourSet</span></code> object. This holds the information about how colors are assigned to values and where the contours are drawn. Since both plots were made with the same parameters, the returned objects are identical in regards to color assignments. Either can be passed into <code class="docutils literal notranslate"><span class="pre">plt.colorbar</span></code>.</p>
<p>To make the colorbar appear below both plots, the <code class="docutils literal notranslate"><span class="pre">ax</span></code> parameter must be set to the lower axes <code class="docutils literal notranslate"><span class="pre">ax2</span></code>. Then <code class="docutils literal notranslate"><span class="pre">orientation</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'horizontal'</span></code>. Additional <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar">keyword arguments</a> can be passed in to <code class="docutils literal notranslate"><span class="pre">plt.colorbar</span></code> to further customize its appearance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function to format and populate subplots</span>
<span class="k">def</span> <span class="nf">create_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
    <span class="c1"># Use geocat.viz.util convenience function to set axes tick values</span>
    <span class="n">gv</span><span class="o">.</span><span class="n">set_axes_limits_and_ticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                 <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>
                                 <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
                                 <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
                                 <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

    <span class="c1"># Use geocat.viz.util convenience function to make plots look like NCL</span>
    <span class="c1"># plots by using latitude, longitude tick labels</span>
    <span class="n">gv</span><span class="o">.</span><span class="n">add_lat_lon_ticklabels</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Remove the degree symbol from tick labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LatitudeFormatter</span><span class="p">(</span><span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>

    <span class="c1"># Use geocat.viz.util convenience function to add minor and major ticks</span>
    <span class="n">gv</span><span class="o">.</span><span class="n">add_major_minor_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Draw coastlines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Use geocat.viz.util convenience function to set titles</span>
    <span class="n">gv</span><span class="o">.</span><span class="n">set_titles_and_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                             <span class="n">maintitle</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                             <span class="n">lefttitle</span><span class="o">=</span><span class="s1">&#39;TS&#39;</span><span class="p">,</span>
                             <span class="n">righttitle</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span>
                             <span class="n">maintitlefontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                             <span class="n">lefttitlefontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">righttitlefontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Creating the figure and subplots</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>  <span class="c1"># Top axes</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>  <span class="c1"># Bottom axes</span>

<span class="c1"># Plotting data</span>
<span class="n">mappable</span> <span class="o">=</span> <span class="n">create_plot</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">first_step</span><span class="p">,</span> <span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">mappable</span> <span class="o">=</span> <span class="n">create_plot</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">last_step</span><span class="p">,</span> <span class="s1">&#39;jet&#39;</span><span class="p">)</span>

<span class="c1"># Making colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="colormap-best-practices">
<h2>Colormap Best Practices<a class="headerlink" href="#colormap-best-practices" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Color is a useful tool for communicating information. However, there are important factors to consider when choosing color palettes that may not be obvious at first.</p>
<div class="section" id="printing-in-black-and-white">
<h3>Printing in Black and White<a class="headerlink" href="#printing-in-black-and-white" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>If your plot is printed in black and white, there can be issues telling the colors apart and interpreting the plot. This is because the colors are reduced to their brightness. Colormaps have a variety of hues and levels of saturation to communicate information, but not all of them are designed to have linear changes in brightness for black and white printing. Below is an example of how the rainbow colormap we used before is hard to interpret in black and white.</p>
<p><a class="reference internal" href="../_images/jet.png"><img alt="Two world maps with temperature contours. The contours are drawn with a rainbow color palette." src="../_images/jet.png" style="width: 250px;" /></a></img>
<a class="reference internal" href="../_images/jet_bw.png"><img alt="Two world maps with temperature contours. The image has been converted to grayscale." src="../_images/jet_bw.png" style="width: 250px;" /></a></img></p>
</div>
<div class="section" id="choosing-accessible-color-palettes">
<h3>Choosing Accessible Color Palettes<a class="headerlink" href="#choosing-accessible-color-palettes" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Colorblindness affects approximately 1 in 12 men and 1 in 200 women <a class="reference external" href="https://www.colourblindawareness.org/colour-blindness/">[1]</a>. To make scientific information accessible to everyone, how different kinds of colorblindness affect the interpretation of color schemes must be taken into account.</p>
<p>Below is an approximation of how someone with deuteranomaly colorblindness would see the plot we created. This kind of color deficiency can be described as “green weakness” since the green receptors in the eyes exist but have differences in how sensitive they are to green light. This is the most common kind of colorblindness, but there are many other types <a class="reference external" href="https://www.color-blindness.com/types-of-color-blindness/">[2]</a>.</p>
<p>Note that some of the colors are now hard to distinguish and the plot is harder to interpret <a class="reference external" href="https://www.color-blindness.com/coblis-color-blindness-simulator/">[3]</a>.
<a class="reference internal" href="../_images/jet.png"><img alt="Two world maps with temperature contours. The contours are drawn with a rainbow color palette." src="../_images/jet.png" style="width: 250px;" /></a></img>
<a class="reference internal" href="../_images/jet_deuteranomaly.png"><img alt="Two world maps with temperature contours. The image has been modified to simulate deuteranomaly color deficiency." src="../_images/jet_deuteranomaly.png" style="width: 250px;" /></a></img></p>
<p>Recommended colormaps for sequential data are <code class="docutils literal notranslate"><span class="pre">viridis</span></code>, <code class="docutils literal notranslate"><span class="pre">plasma</span></code>, <code class="docutils literal notranslate"><span class="pre">inferno</span></code>, <code class="docutils literal notranslate"><span class="pre">magma</span></code>, and <code class="docutils literal notranslate"><span class="pre">cividis</span></code>. These colormaps increase linearly in brightness, thus the actual hue of the colors is not the only way to distinguish them. Below is an example of the <code class="docutils literal notranslate"><span class="pre">plasma</span></code> colormap and how it looks in simulated deuteranomaly and in grayscale. This colormap is still easily interpretable by someone with deuteranomaly and in grayscale printing.</p>
<a class="reference internal image-reference" href="../_images/plasma.png"><img alt="Two world maps with temperature contours. The contours are drawn with a rainbow color palette." src="../_images/plasma.png" style="width: 250px;" /></a>
<a class="reference internal image-reference" href="../_images/plasma_deuteranomaly.png"><img alt="Two world maps with temperature contours. The image has been modified to simulate deuteranomaly color deficiency." src="../_images/plasma_deuteranomaly.png" style="width: 250px;" /></a>
<a class="reference internal image-reference" href="../_images/plasma_bw.png"><img alt="Two world maps with temperature contours. The image has been converted to grayscale." src="../_images/plasma_bw.png" style="width: 250px;" /></a>
</div>
<div class="section" id="alternative-color-palettes">
<h3>Alternative Color Palettes<a class="headerlink" href="#alternative-color-palettes" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Matplotlib has an <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">entire lesson</a> explaining the different classes of colormaps and the appropriate times to use them. It is a more in depth resource for using color than this cookbook and is highly recommended if you want more information on this topic.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Now that you have finished going through this cookbook, you should be able to create multiple plots that use the same colormap and colorbar. Additionally, you should know how colorblindness can affect the interpretation of colormaps and which colormaps are more accessible.</p>
</div>
<div class="section" id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>For more information on choosing colormaps in Matplotlib, see their <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">lesson on colormaps.</a></p>
<p>For more examples of accessible colormaps in scientific visualizations, check out <a class="reference external" href="https://geocat-examples.readthedocs.io/en/latest/gallery/index.html#colors">the color example scripts</a> on the GeoCAT-examples gallery.</p>
<div class="section" id="id1">
<h3><a class="headerlink" href="#id1" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Cartopy. v0.20.3. 29-Jun-2022. Met Office. UK. <a class="reference external" href="https://doi.org/10.5281/zenodo.6775197">doi:10.5281/zenodo.6775197</a>.</p>
<p>Harris, C.R., Millman, K.J., van der Walt, S.J. et al. Array programming with NumPy. Nature 585, 357–362 (2020). <a class="reference external" href="https://doi.org/10.1038/s41586-020-2649-2">doi: 10.1038/s41586-020-2649-2</a>.</p>
<p>J. D. Hunter, “Matplotlib: A 2D Graphics Environment”, Computing in Science &amp; Engineering, vol. 9, no. 3, pp. 90-95, 2007. v3.5.2. <a class="reference external" href="https://doi.org/10.5281/zenodo.6513224">doi:10.5281/zenodo.6513224</a></p>
<p>Hoyer, S., Fitzgerald, S., Hamman, J. et al. (2022). xarray (v2022.03.0) [Software]. <a class="reference external" href="https://doi.org/10.5281/zenodo.6323468">doi:10.5281/zenodo.6323468</a></p>
<p>Visualization &amp; Analysis Systems Technologies. (2022). Geoscience Community Analysis Toolkit: GeoCAT-datafiles (v2022.03.0) [Software]. Boulder, CO, USA: UCAR/NCAR - Computational and Informational System Lab. <a class="reference external" href="https://doi.org/10.5281/zenodo.6684830">doi:10.5281/zenodo.6684830</a>.</p>
<p>Visualization &amp; Analysis Systems Technologies. (2022). Geoscience Community Analysis Toolkit: GeoCAT-viz (v2022.05.0) [Software]. Boulder, CO, USA: UCAR/NCAR - Computational and Informational System Lab. <a class="reference external" href="https://doi.org/10.5281/zenodo.6678351">doi:10.5281/zenodo.6678351</a>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Maplotlib Colorbars Cookbook</p>
        </div>
    </a>
</div>
            </div>
          </div>
        </main>

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer">
  <div class="container-fluid m-0 p-0">
  
    <div class="footer-item">
    
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../_images/NCAR-contemp-logo-blue.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAlbany" src="../_images/UAlbany-A2-logo-purple-gold.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
    <div class="footer-item">
      <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2022.
        
          By the <a href="https://projectpythia.org/">Project Pythia</a> Community.
        
          Last updated on 15 August 2022.
        </p>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
  </div>
</footer>
  </body>
</html>